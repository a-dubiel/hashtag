!function(){var e=$("#posts"),t=$(".board-loading"),a=$(".check-new"),o=1==is_live?0:parseInt($(".check-new").find("span").text()),s="",n,i;e.isotope({animationEngine:"css",masonry:{columnWidth:270,isFitWidth:!0,gutter:20}}),$.ajax({url:base+"/show/board/"+board_id,type:"GET",success:function(e,a,o){"No posts"==e.message?t.html('<div class="no-posts"><i class="fa fa-meh-o"></i><span>Brak wyników</span></div>'):(console.log(e.endpoints),r(e.posts,!1),i=e.endpoints,1==is_logged_in&&d(parseInt(refresh_interval)))},error:function(e,t,a){}});var r=function(a,o){var s=$(a);0==o?s.imagesLoaded(function(){t.remove(),e.isotope("insert",s),$("abbr.timeago").timeago()}):1==o&&s.imagesLoaded(function(){e.prepend(s).isotope("prepended",s),$("abbr.timeago").timeago()})};$(document).on("click",".js-remove-featured",function(e){var t=$(this),a=t.data("post-id");t.removeClass("js-remove-featured").addClass("js-make-featured"),$(".post[data-post-id="+a+"]").removeClass("is-featured-post"),$.ajax({url:base+"/board/post/featured/remove",data:{board_id:board_id,post_id:a,_token:$('meta[name="_token"]').attr("content")},type:"POST",success:function(e,t,o){"max"==e&&(alert("Limit promowanych postów przekroczony!"),$(".post[data-post-id="+a+"]").removeClass("is-featured-post"))},error:function(e,t,a){}}),e.preventDefault()}),$(document).on("click",".js-make-featured",function(e){var t=$(this),a=t.data("post-id");t.removeClass("js-make-featured").addClass("js-remove-featured"),$(".post[data-post-id="+a+"]").addClass("is-featured-post"),post_data=$(".post[data-post-id="+a+"]").clone().wrap("<div>").parent().html(),$.ajax({url:base+"/board/post/featured",data:{board_id:board_id,post_id:a,post:post_data,_token:$('meta[name="_token"]').attr("content")},type:"POST",success:function(e,t,o){"max"==e&&(alert("Limit promowanych postów przekroczony!"),$(".post[data-post-id="+a+"]").removeClass("is-featured-post"))},error:function(e,t,a){}}),e.preventDefault()}),$(".filters").on("click","a.filter",function(){var t=$(this);t.attr("data-filter")==n?($("a.filter").removeClass("active").removeClass("inactive"),n="*"):($("a.filter").removeClass("active").addClass("inactive"),t.removeClass("inactive").addClass("active"),n=t.attr("data-filter")),e.isotope({filter:n})}),$(".load-more").click(function(e){$el=$(this),$el.html('<i class="fa fa-circle-o-notch fa-spin"></i>'),$.ajax({url:base+"/show/board/more/"+board_id,data:{endpoints:i,_token:$('meta[name="_token"]').attr("content")},type:"POST",success:function(e,t,a){"No posts"==e.message?$el.remove():(r(e.posts,!1),i.twitter_max_id=e.endpoints.twitter_max_id,i.instagram_max_id=e.endpoints.instagram_max_id,i.google_token=e.endpoints.google_token,i.facebook_until_id=e.endpoints.facebook_until_id,$el.html("Pokaż więcej"))},error:function(e,t,a){}}),e.preventDefault()});var d=function(e){var t=0,n=setInterval(function(){console.log(refresh_count),console.log(t),t<parseInt(refresh_count)?(50>=o&&$.ajax({url:base+"/show/board/new/"+board_id,data:{endpoints:i,_token:$('meta[name="_token"]').attr("content")},type:"POST",success:function(e,t,n){console.log(e),"No posts"!=e.message&&(i.twitter_since_id=e.endpoints.twitter_since_id,i.instagram_min_tag=e.endpoints.instagram_min_tag,i.facebook_since_id=e.endpoints.facebook_since_id,i.vine_since_id=e.endpoints.vine_since_id,1==is_live?(s+=e.posts,r(s,!0),s=""):(a.removeClass("inactive"),o+=e.count,a.find("span").text(o),$("title").text("("+o+") #"+hashtag+" | hashtag.info"),s+=e.posts))},error:function(e,t,a){}}),t++):clearInterval(n)},1e3*e)};$(".check-new").click(function(e){if(e.preventDefault(),0==is_logged_in)$.ajax({url:base+"/popup/login",type:"POST",data:{_token:$('meta[name="_token"]').attr("content"),path:window.location.pathname},success:function(e,t,a){$.magnificPopup.close(),$.magnificPopup.open({items:{src:e,type:"inline"},callbacks:{markupParse:function(e,t,a){console.log("Parsing:",e,t,a)}}})},error:function(e,t,a){}});else{if($(this).hasClass("inactive"))return;s.length>0&&(r(s,!0),s="",o=0,a.addClass("inactive").find("span").text("0"),$("title").text("#"+hashtag+" | hashtag.info"))}})}();